/*!
  Tinycon - A small library for manipulating the Favicon
  Tom Moor, http://tommoor.com
  Copyright (c) 2012 Tom Moor
  MIT Licensed
  @version 0.5
*/
(function(){var f={},l=null,m=null,q=document.title,h=null,k=null,e={},n={width:7,height:9,font:"10px arial",colour:"#ffffff",background:"#F03D25",fallback:!0,abbreviate:!0},c,r=navigator.userAgent.toLowerCase();c=function(a){return-1!==r.indexOf(a)};var s=c("msie");c("chrome");var t=c("chrome")||c("safari"),u=c("safari")&&!c("chrome"),v=c("mozilla")&&!c("chrome")&&!c("safari"),j=function(){k||(k=document.createElement("canvas"),k.width=16,k.height=16);return k},p=function(a){for(var d=document.getElementsByTagName("link"),
b=document.getElementsByTagName("head")[0],e=0,c=d.length;e<c;e++)"undefined"!==typeof d[e]&&(d[e].getAttribute("rel")||"").match(/\bicon\b/)&&b.removeChild(d[e]);d=document.createElement("link");d.type="image/x-icon";d.rel="icon";d.href=a;document.getElementsByTagName("head")[0].appendChild(d)};f.setOptions=function(a){e={};for(var d in n)e[d]=a.hasOwnProperty(d)?a[d]:n[d];return this};f.setImage=function(a){l=a;j().getContext&&p(j().toDataURL());return this};f.setBubble=function(a){var d=a||"";
if(!j().getContext||s||u||"force"===e.fallback)e.fallback&&(document.title=0<(d+"").length?"("+d+") "+q:q);else{var b=j().getContext("2d");if(!m||!l){b:{a=document.getElementsByTagName("link");for(var c=0,f=a.length;c<f;c++)if((a[c].getAttribute("rel")||"").match(/\bicon\b/)){a=a[c];break b}a=!1}m=l=a?a.getAttribute("href"):"/favicon.ico"}a=l;h=new Image;h.onload=function(){b.clearRect(0,0,16,16);b.drawImage(h,0,0,h.width,h.height,0,0,16,16);if(0<(d+"").length){var a=d;if("number"==typeof a&&99<a&&
e.abbreviate)for(var c=[["G",1E9],["M",1E6],["k",1E3]],g=0;g<c.length;++g)if(a>=c[g][1]){a=(new Number(a/c[g][1])).toFixed(void 0)+c[g][0];break}var c=e.width+6*((a+"").length-1),g=16-c,f=16-e.height;b.font=(t?"bold ":"")+e.font;b.fillStyle=e.background;b.strokeStyle=e.background;b.lineWidth=1;b.fillRect(g,f,c-1,e.height);b.beginPath();b.moveTo(g-0.5,f+1);b.lineTo(g-0.5,15);b.stroke();b.beginPath();b.moveTo(15.5,f+1);b.lineTo(15.5,15);b.stroke();b.beginPath();b.strokeStyle="rgba(0,0,0,0.3)";b.moveTo(g,
16);b.lineTo(15,16);b.stroke();b.fillStyle=e.colour;b.textAlign="right";b.textBaseline="top";b.fillText(a,15,v?7:6)}j().getContext&&p(j().toDataURL())};a.match(/^data/)||(h.crossOrigin="anonymous");h.src=a}return this};f.reset=function(){p(m)};f.setOptions(n);window.Tinycon=f;"function"===typeof define&&define.amd&&define(f)})();